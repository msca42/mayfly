# 预处理器

- 在编译前处理C程序，C和C++独有
- 主要内容
    - 工作原理
    - 影响预处理指令的通用规则
    - 预处理器的两种能力
        - 宏定义
        - 条件编译
    - 较少用到的预处理指令
        - #error
        - #line
        - #pragma

## 预处理器的工作原理
- #define:
    - 定义一个宏，用来表示其他东西的名字
    - 预处理器会将宏的名字和定义存储在一起，当程序中使用到宏时，将定义进行替换
- #include:
    - 告诉与处理器打开一个特定文件，将它的内容作为正在编译的文件的一部分包含起来
- 工作原理
    - 将当前指令行替换为空，并将特定文件内容整合到当前文件中，交给编译器
    - 宏定义会将宏替换为指定内容
    - 加载指令会将特定文件加载进当前文件
- 显示输出
    - 通过gcc -E可以显示预处理后的代码

## 预处理指令
- 三种类型
    - 宏定义
        - #define 定义一个宏
        - #undef 删除一个宏
    - 文件包含
        - #include 将指定文件包含在程序中
    - 条件编译
        - #if等 根据预处理器可以测试的条件确定文本块的位置

- 指令规则
    - 以#开始，不需要在行首，只需要它之前由空白符
    - 指令的符号之间可以插入任意数量的空格和水平制表符
    - 指令总是在第一个换行符处结束，如果要延续需要在行末加上\
    - 指令可以出现在程序的任何地方
    - 注释和指令可以在同一行 

## 宏定义
- 宏可以分为简单宏和带参数的宏
    - 简单的宏
        - 格式: #define 标识符 替换列表
        - 替换列表可以包含标识符、关键字、数值常量、字符常量、字面串、运算符和标点符号
        - 使用场景: 
            - 表示数值、字符值和字符串值
            - 类型重命名
            - 控制条件编译(todo)
    - 带参数的宏
          - 格式: #define 标识符(x1,x2) 替换列表
          - 使用场景
            - 作为简单函数使用
                - 优点
                    - 相对程序执行函数，没有额外开销(存储上下文信息、复制参数的值)
                    - 宏没有参数类型，它可以接收任何类型
                - 缺点
                    - 编译后的代码变大
                    - 宏参数没有类型检查
                    - 无法使用指针
                    - 多次运算可能存在副作用
            - 重复书写代码片段
- 宏定义可以包含两个专用运算符
    - #运算符
        - 
    - ##运算符
- 宏的通用属性
- 宏定义中的圆括号
- 创建较长的宏
- 预定义宏
- C99中新增的预定义宏
- 空的宏参数
- 参数个数可变的宏
- _func_标识符
## 条件编译
- #if指令和#endif指令
- defined运算符
- #ifdef指令和#ifndef指令
- #elif指令和#else指令
- 使用条件编译
## 其他指令
- #error指令
- #line指令
- #pragma指令
- _Pragma运算符