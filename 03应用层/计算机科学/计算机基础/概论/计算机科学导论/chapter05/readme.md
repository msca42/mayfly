# 计算机组成

## 引言

- 计算机的组成部件可以分为中央处理器、主存储器和输入/输出子系统

## 中央处理单元

- 组成部件: 算术逻辑单元、控制单元、寄存器组
- 算术逻辑单元 ALU
  - 对数据进行逻辑、移位和算术运算
- 寄存器
  - 存放临时数据的高速独立的存储单元
  - 分类
    - 数据寄存器
      - 存放输入数据和运算结果，命名从 R<sub>1</sub>到 R<sub>n</sub>
    - 指令寄存器
      - 通用寄存器
      - CPU 从内存中将指令逐条取出，并存储在指令寄存器中，解释并执行
    - 程序计数器
      - 通用寄存器
      - 保存当前正在执行的指令，该指令执行完后，计数器自动加 1
- 控制单元
  - 控制各个子系统的操作
  - 控制操作的介质是不同单元系统 之间通信的电信号

## 主存储器

- 存储单元的集合，每个存储单元都有一个唯一标识(地址)
- 数据以字为单位在内存中传递，字的长度是 8 的倍数
- 地址空间
  - 在软件层面上，程序员使用命名的方式来区分字
  - 在硬件层面上，每个字通过地址来标识
  - 地址空间: 存储器中标识的独立的地址单元的总数
  - 作为位模式的地址
    - 一个内存是 64K，字长 1 字节，需要 16 位的位模式来确定地址
    - 一个计算机有 N 个字的存储空间，就需要 log<sub>2</sub>N 位的无符号整数来确定一个存储单元
- 存储器的类型
  - RAM 随机存取存储器
    - 使用存储单元地址来随机存取一个数据项，而不需要存取位于它前面的所有数据项
    - 用户可以读写，当系统断电后，信息将丢失
      - SRAM 使用触发器门电路保存数据，门保持状态 0 或 1，通电时数据始终存在
      - DRAM 使用电容器，充电时，状态时 1，放电时，状态是 0
  - ROM 只读存储器
    - 内容由制造商写入，用户只能读不能写，非易失性
      - PROM
        - 可编程只读存储器，发货时空白，计算机用户可以借助特殊设备将程序存储
      - EPROM
        - 可擦除可编程只读存储器，可以使用一种发出紫外光的特殊仪器擦写
      - EEPROM
        - 电可擦除可编程只读存储器
- 存储器的层次结构
  - 寄存器
    - 对速度要求很苛刻
  - 高速缓冲存储器
    - 存储经常需要访问的数据
    - 任何时候都包含主存中一部分内容的副本
  - 主存
    - 存储不经常访问的数据
- 存储器运行流程
  - CPU 检查高速缓冲存储器
  - 如果要存取的信息在高速缓冲存储器中，CPU 将其复制
  - 如果不存在，CPU 从主存中复制从需要读写的字开始的数据块，该数据块覆盖高速缓冲存储器

## 输入/输出子系统

- 非存储设备
  - 键盘、监视器
  - 打印机
- 存储设备
  - 磁介质存储设备
  - 光存储设备

## 子系统的互连

- CPU 和存储器的连接
  - 数据总线
    - 用于传递数据
    - 多根线组成，每根线传递 1 位数据
    - 线的数量取决于字的大小
  - 地址总线
    - 允许访问存储器中某个字，线数取决于存储空间的大小
    - 如果存储容量为 2^n，那么地址总线需要传送 n 位的地址数据，n 根线
  - 控制总线
    - 在中央处理器和内存之间传递信息
    - m 根线对应 2^m 个控制命令
- I/O 设备的连接
  - CPU 和内存是电子设备，输入输出设备是机电、磁性或光学设备，相较而言，后者的操作速度很慢，为了应对这种差异，需要一个控制器或接口将 I/O 设备连接到总线上
  - 控制器可以分为串行或并行设备
  - 串行只有一根数据线，并行有树根数据线
  - 常见控制器: SCSI、火线、USB 和 HDMI
- 输入/输出设备的寻址
  - 数据在 CPU 和输入输出设备之间传递的方式
  - I/O 独立寻址
    - 用来读写内存的指令和用来读写输入输出设备的指令不同，后者有专门的指令
    - 每个 IO 设备都有自己独立的地址，通过专有指令执行
  - I/O 存储器映射寻址
    - 没有单独的指令，将 IO 设备看作内存中的存储单元
    - 指令集较小、使用同一套内存操作指令，输入输出控制器占用内存地址

## 程序执行

- 通用计算机通过被称为程序的一系列指令处理数据
- 机器周期
  - 取指令
    - 控制单元将下一条要执行的指令复制到 CPU 的指令寄存器 IR
    - 被复制的指令地址保存在程序计数器 PC
    - 程序计数器自动加 1 指向内存中的下一条指令
  - 译码
    - 控制单元将指令寄存器中的指令译码，生成可执行的二进制代码
  - 执行
    - 控制单元发送命令到 CPU 部件，让它从内存中读取数据，运算之后保存到输出寄存器
- 输入/输出操作
  - 计算机需要通过命令把数据从 IO 设备传输到 CPU 和内存，但是 IO 设备的运行速度和 CPU 不一致，所以产生了同步的需求
  - CPU 和输入/输出设备同步方式
    - 程序控制输入/输出
      - CPU 等待 IO 设备
        - 数据传输通过指令实现，当 CPU 遇到 IO 指令，停止工作直到数据传输完毕
        - CPU 不断查询 I/O 状态知道可以执行
    - 中断控制输入/输出
      - CPU 无需查询 IO 状态
      - I/O 设备准备好之后，通知 CPU(中断)
    - 直接存储器存取 DMA
      - 用于在高速 IO 设备间传输大量的数据块
      - 通过 DMA 控制器临时存储数据块作为临时中介

## 不同的体系结构

- CISC
  - 复杂指令集计算机
  - 策略: 使用大量的指令，每一项任务都有一条对应的指令
  - 指令集的复杂性导致一个结果，CPU 和控制单元的电路非常复杂
    - 减少复杂性的方案
      - CPU 不直接执行机器语言指令
      - CPU 只执行被称为微操作的简单操作
  - 复杂指令被转换为一系列简单操作后，由 CPU 执行
    - 微内存负责保存指令集中每个复杂指令的一系列操作
    - 使用微操作的程序设计被称为微程序设计
- RISC
  - 精简指令集计算机
  - 策略：使用少量的指令完成最少的简单操作
- 流水线
  - 不同指令的取指令、译码和执行同时进行，而非等待上一条指令执行完成之后进行
- 并行处理
  - 通过多个控制单元、算术逻辑单元和内存单元实现
  - 组织结构
    - SISD: 单指令流单数据流
    - SIMD：单指令流多数据流
    - MISD：多指令流单数据流
    - MIMD：多指令流多数据流

## 简单计算机

- 组成：CPU、存储器、输入输出子系统
- CPU
  - 数据寄存器
    - 16 个 16 位的数据寄存器
  - 算术逻辑单元
  - 控制单元
    - 控制 ALU 的操作，对内存、IO 设备的存取
    - 具有两个专用寄存器，程序计数器和指令寄存器
- 主存
  - 主存中既有数据又有程序指令
- 指令集
  - 指令由两部分组成：操作码和操作数
  - 操作码指明操作的类型
